@model dmDateRange

@{
    ViewData["Title"] = "首頁登入統計圖";
    Layout = "_LayoutAdmin";
}

<div class="row mx-1">
    <div class="col-md-12">
        <div class="float-start ms-1">
            @using (Html.BeginForm(ActionService.Index, ActionService.Controller, new { area = ActionService.Area }))
            {
                <table>
                    <tr>
                        <td>
                            <span class="control-label fw-bold">日期範圍：</span>
                        </td>
                        <td class="pe-2">
                            @Html.EditorFor(model => model.StartDate, new { htmlAttributes = new { @class = "form-control datepicker", @type = "text" } })
                        </td>
                        <td>
                            <span class="control-label fw-bold">至</span>
                        </td>
                        <td class="p-2">
                            @Html.EditorFor(model => model.EndDate, new { htmlAttributes = new { @class = "form-control datepicker", @type = "text" } })
                        </td>
                        <td>
                            <button type="submit" class="btn btn-primary"><i class="fa fa-filter"></i> 篩選
                            </button>
                    </tr>
                </table>
            }
        </div>
    </div>
</div>
<hr />

<div id="div-chart" class="p-5">
    <canvas id="LoginChartCanvas"></canvas>
</div>

@section ScriptsBody
{
    <script>
        Chart.register(ChartDataLabels);
        $.ajax({
            type: "get",
            url: "@Url.Action("ChartData", ActionService.Controller, new { area = ActionService.Area })",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (result) {
            var ctx1 = document.getElementById("LoginChartCanvas").getContext("2d");
            window.myBar = new Chart(ctx1,
                {   type: 'line',
                    data: {
                        labels: result.Labels,
                        datasets: [{
                                label: result.SerialName[0],  // 資料標籤文字
                                backgroundColor: "#ea464d",  // 背景顏色
                                borderColor: "#ea464d",  // 外框顏色
                                borderWidth: 5,  // 外框寛度
                                fill: false,  // 是否填滿色彩
                                data: result.Values,  // 資料
                                lineTension: 0, // 曲線的彎度，設0 表示直線
                                showLine: true, // 顯示直線(false=只有圓點)
                                pointRadius: 1, // 顯示圖點(1=是,0=否)
                            }]},
                    options:{
                        plugins: {
                            legend: {
                                display: false ,
                                position: "top",  // 垂直位置 (top/left/bottom/right)
                                align: "end",  // 水平位置 (start/center/end)
                                labels: {
                                    font: {
                                        size: 14
                                    }}},
                            title: {
                                display: true,  // 顯示標題文字
                                text: result.Title,  // 標題文字
                                padding: {
                                    top: 10,  // 上邊界
                                    bottom: 10  // 下邊界
                                },
                                font: {
                                        weight: "bold",  // 粗體字
                                        size: 24  // 字型大小 24
                                    }},
                            subtitle: {
                                display: true,  // 顯示副標題文字
                                text: result.SubTitle,  // 副標題文字
                                padding: {
                                    bottom: 10  // 下邊界
                                },
                                font: {
                                        size: 20  // 字型大小 20
                                    }},
                            tooltips: {
                                enabled: false
                                    },
                            datalabels: { // 顯示數字標籤
                                anchor: "end",
                                align: "top",
                                color: "#ff0000",
                                formatter: function(value, context) {
                                    return value.toLocaleString();
                                    },
                                font: {
                                        size: 16
                                    }}
                        },
                        scales: {
                            x: {
                                display: true
                            },
                            y: {
                                display: true,
                                type: "linear"
                            }},
                        datasets: {
                            line: {
                                pointRadius: 1 // 顯示圖點(1=是,0=否)
                            }
                        },
                        elements: {
                            point: {
                                radius: 0 // 顯示圖點(1=是,0=否)
                            }
                        },
                        locale: 'zh-TW',
                        animation: true,  // 顯示動畫
                        responsive: true,  // 營幕自適應
                        showLine: true, // 顯示直線(false=只有圓點)
                        spanGaps: true, // enable for all datasets
                        maintainAspectRatio: true
                }});}
            });
    </script>
}